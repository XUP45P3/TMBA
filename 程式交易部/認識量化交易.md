<h1 align="center">量化交易</h1>

### 什麼是量化交易？

##### 用數據 + 程式化規則，做可重複的交易決策。


### 量化流程

##### 資料取得 → 策略設計 → 回測驗證 → 下單執行 → 績效監控

- 資料取得
    - 種類：周K、日K、分K、Tick
    - 來源：TEJ、Yahoo Finance、FinMind

- 策略設計
    - 策略：CTA、套利、事件研究
    - 量化指標：有明確的進出場條件、可重複規則

- 回測驗證
    - 用歷史資料模擬交易，執行策略
    - 考量交易成本 (手續費 & 滑價)

- 下單執行
    - 串券商的 API 完成自動化交易
    - 風險控管 (風控)

- 績效監控
    - 策略不是設定好就讓他放著跑，需要定期檢視績效和參數調整、異常狀況
    - 確認下單機是否有實務上的 Bug


### 策略設計

- 趨勢追蹤：利用技術指標 or 量能訊號，做多/做空延續性趨勢
    - Ex：均線交叉 (MA5 金叉 MA20)

- 均值回歸：假設股價會回歸歷史平均，當價格大幅偏離均值(乖離過大)時，反向操作

- 統計套利：最經典的例子 → 兩檔高度相關的標的，假設兩檔標的會回到一樣的價格，做空價格較高的標的，做多價格較低的標的
    - Ex：2330 & 2330ADR 、 2454 & 2325 、 百事可樂 & 可口可樂

- 事件驅動：檢查事件發生前與發生後是否出現超額報酬
    - Ex：財報、併購、重大消息、特殊事件

### 回測時的三大陷阱

- 倖存者偏差
    - 只看到還活著的股票，卻忽略了早就陣亡的輸家 (下市的標的)，導致高估了績效
    - Ex：分析 Top50 的股票，結果跑出來的報酬超漂亮，But 卻忽略已經下市 or 被合併的標的 (只分析存活下來的菁英)

- 低估成本
    - 模擬時忽略手續費、滑價、稅金，導致「賺在回測，虧在實盤」
    - 買進：成交金額 × 0.1425%      賣出：成交金額 × 0.1425% × 0.3%

- 前視偏誤
    - 用到未來才知道的資訊做決策，像是考試前偷看答案
    - Ex：使用隔天的開盤價 or 財報日期
    - 數據對齊 is relly important！！！

### 風險管理 (風控)

- 好的風險管理比找到千里馬還重要

- 常見的風險指標
    - Sharpe Ratio：單位風險所帶來的超額報酬

        **$Sharpe Ratio=\frac{E[R_{p}] - R_{f}}{σ_{p}}$**

      - $R_{f}$ 通常會直接忽略
      - Sharpe Ratio 2 以上是基本

    ────────────────────

    - Max DrawDown：從歷史高點至下一低點的最大跌幅，衡量極端下跌風險

        **$MaxDD=Max\left(\frac{P_{peak} - P_{t}}{P_{peak}}\right)$**

    ────────────────────

    - Beta：與基準指數的聯動程度 (通常與大盤相比)

        **$Beta=\frac{Cov(r_{策略},r_{基準})}{var(r_{基準})}$**

        - 數值越接近 1，相關程度越高
        - 要注意是否與大盤的相關性過高，如果相關性太高，就直接去投大盤就好了

        - 當你有很多投組時，可以檢視各投組之間的相關程度
        - 如果兩個投組高度相關，那是否只要選擇一個就好

### 倉位大小

- 固定比例法：將資金分為 1%、2%、5%、10%，每次下單都使用同樣比例

- Kelly 公式

    **$f=\frac{b_{p} - q}{b}$**

    - p = 勝率      q = 1 - p = 敗率        b = 賺賠比
    - 算出來的值就是它建議你將多少的資金投入此投組中
    - But！ Kelly 公式追求長期最大化成長，但波動過大，所以建議使用「半 kelly」較舒服

### 風控三道防線

- 人工監控：盤後由人員檢視異常 or 市場異動

    1. 檢查是否異常下單 or 系統誤判
    2. 回顧今天市場突發事件是否影響模型
    3. 評估策略表現，是否需要立即調整的地方

- 風控參數：事先定義單筆、當日、當週最大虧損闊值，超標立即平倉 or 縮倉

    1. 單筆最大虧損
    2. 當日累計虧損
    3. 週度最大虧損

- 程式層面：下單前自動檢查資金 and 止損/停利設定

    1. 資金夠不夠
    2. 停損、停利參數是否設定好
    3. 是否有超出當前持倉限制